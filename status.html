<!DOCTYPE html><html lang="pt-BR"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Talkio ‚Äì Status</title><link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&family=DM+Sans:opsz,wght@9..40,400;9..40,500&display=swap" rel="stylesheet">
<style>:root{--brand:#00C9FF;--brand2:#0077FF;--accent:#FF3CAC;--bg0:#070B14;--bg1:#0C1220;--bg2:#111927;--bg3:#18243A;--t1:#EEF3FF;--t2:#8898B8;--t3:#4A5878;--border:rgba(0,201,255,0.12);--border2:rgba(0,201,255,0.28);--r-md:14px;--r-full:9999px;--trans:0.22s;--font-d:'Syne',sans-serif;--font-b:'DM Sans',sans-serif}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{font-family:var(--font-b);background:var(--bg0);color:var(--t1);min-height:100dvh;padding-bottom:80px;-webkit-font-smoothing:antialiased}
::-webkit-scrollbar{width:3px}::-webkit-scrollbar-thumb{background:var(--border2);border-radius:3px}
.topbar{position:sticky;top:0;z-index:50;background:rgba(7,11,20,.9);backdrop-filter:blur(12px);height:60px;display:flex;align-items:center;padding:0 16px;gap:12px;border-bottom:1px solid var(--border)}
.logo{display:flex;align-items:center;gap:8px;text-decoration:none;color:var(--t1)}.logo-mark{width:30px;height:30px;border-radius:8px;background:linear-gradient(135deg,var(--brand),var(--brand2));display:flex;align-items:center;justify-content:center}.logo-name{font-family:var(--font-d);font-weight:800;font-size:1rem}.logo-name span{color:var(--brand)}
.page-title{font-family:var(--font-d);font-weight:700;font-size:1rem;flex:1}
.container{max-width:640px;margin:0 auto;padding:20px 16px}
.section{background:var(--bg1);border:1px solid var(--border);border-radius:20px;padding:20px;margin-bottom:14px}
.section-title{font-family:var(--font-d);font-weight:700;font-size:.8rem;color:var(--t3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:16px}
.setting-row{display:flex;align-items:center;justify-content:space-between;padding:12px 0;border-bottom:1px solid var(--border)}.setting-row:last-child{border-bottom:none;padding-bottom:0}.setting-row:first-child{padding-top:0}
.setting-info{flex:1;min-width:0}.setting-label{font-size:.88rem;font-weight:600;margin-bottom:2px}.setting-desc{font-size:.75rem;color:var(--t2)}
.toggle{width:44px;height:24px;background:var(--bg3);border-radius:12px;border:none;cursor:pointer;position:relative;transition:var(--trans);flex-shrink:0}.toggle::after{content:'';position:absolute;width:18px;height:18px;background:#fff;border-radius:50%;top:3px;left:3px;transition:var(--trans)}.toggle.on{background:var(--brand)}.toggle.on::after{left:23px}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:6px;padding:9px 18px;border-radius:var(--r-full);font-family:var(--font-d);font-weight:600;font-size:.82rem;cursor:pointer;border:none;transition:var(--trans)}
.btn-primary{background:linear-gradient(135deg,var(--brand2),var(--brand));color:#fff;box-shadow:0 2px 12px rgba(0,201,255,.3)}.btn-primary:hover{box-shadow:0 4px 20px rgba(0,201,255,.45);transform:translateY(-1px)}.btn-primary:disabled{opacity:.5;cursor:not-allowed;transform:none}
.btn-ghost{background:var(--bg2);color:var(--t1);border:1px solid var(--border2)}.btn-ghost:hover{background:var(--bg3)}
.btn-sm{padding:7px 14px;font-size:.78rem}.btn-full{width:100%}
.form-input{width:100%;background:var(--bg0);border:1px solid var(--border2);border-radius:12px;padding:12px 16px;color:var(--t1);font-size:.9rem;font-family:var(--font-b);outline:none;transition:var(--trans)}.form-input:focus{border-color:var(--brand);box-shadow:0 0 0 3px rgba(0,201,255,.1)}
.form-group{margin-bottom:14px}.form-label{display:block;font-size:.76rem;font-weight:600;color:var(--t2);margin-bottom:6px;text-transform:uppercase;letter-spacing:.04em}
.toaster{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);z-index:9999;pointer-events:none;display:flex;flex-direction:column;gap:8px;align-items:center}
.toast{background:var(--bg3);border:1px solid var(--border);border-radius:var(--r-full);padding:8px 18px;font-size:.82rem;box-shadow:0 8px 32px rgba(0,0,0,.5);animation:tin .3s ease,tout .3s ease 2.7s forwards}
@keyframes tin{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}@keyframes tout{from{opacity:1}to{opacity:0}}
.mobile-nav{position:fixed;bottom:0;left:0;right:0;height:64px;background:var(--bg1);border-top:1px solid var(--border);display:flex;align-items:center;justify-content:space-around;z-index:200}
.mnb{display:flex;flex-direction:column;align-items:center;gap:4px;padding:8px 12px;cursor:pointer;color:var(--t3);font-size:.62rem;font-family:var(--font-d);font-weight:600;letter-spacing:.04em;transition:var(--trans);background:none;border:none;text-transform:uppercase}.mnb svg{width:22px;height:22px}.mnb.active{color:var(--brand)}
.status-ring{position:relative;width:64px;height:64px;border-radius:50%;flex-shrink:0;cursor:pointer}
.status-ring::before{content:'';position:absolute;inset:-3px;border-radius:50%;background:conic-gradient(var(--brand),var(--brand2),var(--brand));animation:rot 4s linear infinite}
@keyframes rot{to{transform:rotate(360deg)}}
.status-ring-inner{position:absolute;inset:3px;border-radius:50%;background:var(--bg0);display:flex;align-items:center;justify-content:center;overflow:hidden;font-family:var(--font-d);font-weight:700;font-size:1rem;color:#000}
.status-card{background:var(--bg1);border:1px solid var(--border);border-radius:16px;overflow:hidden;cursor:pointer;transition:var(--trans)}.status-card:hover{border-color:var(--border2)}
.status-card-placeholder{height:140px;display:flex;align-items:center;justify-content:center;font-size:1.8rem}
.compose-overlay{position:fixed;inset:0;z-index:1000;background:rgba(0,0,0,.95);display:none;flex-direction:column}.compose-overlay.open{display:flex}
.compose-bg{flex:1;display:flex;align-items:center;justify-content:center;position:relative}
.view-overlay{position:fixed;inset:0;z-index:1000;background:#000;display:none;flex-direction:column}.view-overlay.open{display:flex}
.view-progress{height:3px;background:rgba(255,255,255,.2);margin:0 2px}.view-progress-bar{height:100%;background:#fff;animation:vprog 5s linear forwards}
@keyframes vprog{from{width:0}to{width:100%}}
.view-content{flex:1;display:flex;align-items:center;justify-content:center}
</style></head><body>
<div class="topbar">
  <a class="logo" href="chat.html"><div class="logo-mark"><svg viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2.2" stroke-linecap="round" width="16" height="16"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/><circle cx="9" cy="10" r="1" fill="#fff"/><circle cx="12" cy="10" r="1" fill="#fff"/><circle cx="15" cy="10" r="1" fill="#fff"/></svg></div><span class="logo-name">Talk<span>io</span></span></a>
  <span class="page-title">Status</span>
</div>
<div class="container">
  <div style="display:flex;align-items:center;gap:12px;padding:16px;background:var(--bg1);border:1px solid var(--border);border-radius:16px;margin-bottom:14px;cursor:pointer;" onclick="openCompose()">
    <div style="width:54px;height:54px;border-radius:50%;background:linear-gradient(135deg,var(--brand2),var(--brand));display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:0 0 20px rgba(0,201,255,.3)"><svg viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2.5" stroke-linecap="round" width="22" height="22"><path d="M12 5v14M5 12h14"/></svg></div>
    <div><div style="font-size:.9rem;font-weight:600;">Meu status</div><div style="font-size:.78rem;color:var(--t2);" id="myStatusSub">Toque para adicionar um status</div></div>
    <div style="margin-left:auto;display:flex;gap:8px;">
      <button class="btn btn-ghost btn-sm" onclick="event.stopPropagation();openCompose('text')">‚úèÔ∏è Texto</button>
      <button class="btn btn-ghost btn-sm" onclick="event.stopPropagation();document.getElementById('statusMedia').click()">üì∑ Foto</button>
    </div>
  </div>
  <div style="font-size:.75rem;font-family:var(--font-d);font-weight:700;color:var(--t3);text-transform:uppercase;letter-spacing:.08em;margin-bottom:10px;">Atualiza√ß√µes recentes</div>
  <div id="statusGrid" style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;"></div>
  <div id="emptyStatus" style="display:none;text-align:center;padding:60px 20px;color:var(--t2);">
    <div style="font-size:3rem;margin-bottom:12px;">‚≠ï</div>
    <p style="font-size:.85rem;">Nenhuma atualiza√ß√£o nas √∫ltimas 24h</p>
  </div>
</div>
<input type="file" id="statusMedia" accept="image/*,video/*" style="display:none" onchange="loadMedia(event)">

<div class="compose-overlay" id="composeOverlay">
  <div style="display:flex;align-items:center;gap:10px;padding:16px;flex-shrink:0;">
    <button onclick="closeCompose()" style="background:none;border:none;color:#fff;cursor:pointer;padding:6px;"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" width="20" height="20"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
    <span style="font-family:var(--font-d);font-weight:700;">Novo status</span>
    <button class="btn btn-primary btn-sm" style="margin-left:auto;" onclick="postStatus()">Publicar</button>
  </div>
  <div class="compose-bg" id="composeBg" style="background:#111927;">
    <div id="composeTextPrev" style="font-family:var(--font-d);font-size:1.5rem;font-weight:700;text-align:center;padding:24px;color:#fff;max-width:340px;display:none;"></div>
    <img id="composeImgPrev" style="max-width:100%;max-height:100%;object-fit:contain;display:none;">
  </div>
  <div style="background:rgba(0,0,0,.8);padding:16px;display:flex;flex-direction:column;gap:10px;">
    <input type="text" id="composeCaption" placeholder="Escreva algo..." style="background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.15);border-radius:9999px;padding:10px 16px;color:#fff;font-family:var(--font-b);font-size:.9rem;outline:none;" oninput="updatePrev()">
    <div style="display:flex;gap:8px;flex-wrap:wrap;" id="colorDots"></div>
  </div>
</div>

<div class="view-overlay" id="viewOverlay">
  <div id="viewBars" style="display:flex;gap:4px;padding:10px 12px 0;"></div>
  <div style="display:flex;align-items:center;gap:10px;padding:12px 16px;">
    <div style="width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:var(--font-d);font-weight:700;font-size:.82rem;color:#000;" id="viewAv">?</div>
    <div><div style="font-size:.88rem;font-weight:600;" id="viewName"></div><div style="font-size:.72rem;color:rgba(255,255,255,.5);" id="viewTime"></div></div>
    <button onclick="closeView()" style="margin-left:auto;background:none;border:none;color:rgba(255,255,255,.7);cursor:pointer;"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" width="18" height="18"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
  </div>
  <div class="view-content" id="viewContent"></div>
</div>

<div class="toaster" id="toaster"></div>
<nav class="mobile-nav">
<button class="mnb" onclick="location.href='chat.html'"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" width="22" height="22"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/></svg>Chat</button>
<button class="mnb" onclick="location.href='grupo.html'"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" width="22" height="22"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/></svg>Grupos</button>
<button class="mnb" onclick="location.href='chamada.html'"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" width="22" height="22"><path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07A19.5 19.5 0 013.07 8.63 19.79 19.79 0 01.12 2.18 2 2 0 012.11 0h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L6.09 7.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/></svg>Liga√ß√µes</button>
<button class="mnb" onclick="location.href='status.html'"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" width="22" height="22"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="3"/></svg>Status</button>
<button class="mnb" onclick="location.href='perfil.html'"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" width="22" height="22"><path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>Perfil</button>
</nav>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL='https://SEU_PROJETO.supabase.co';const SUPABASE_KEY='SUA_CHAVE_ANON_PUBLICA';const sb=supabase.createClient(SUPABASE_URL,SUPABASE_KEY);
let uid=null,selectedColor='#111927',selectedMedia=null;
const BG=['#0C1220','#111927','#1A0030','#003020','#300010','#002050','#201000','#001830'];
const GRAD=['linear-gradient(135deg,#0077FF,#00C9FF)','linear-gradient(135deg,#FF3CAC,#784BA0)','linear-gradient(135deg,#00C9FF,#00E676)','linear-gradient(135deg,#FFB300,#FF3D00)'];
function grad(id){return GRAD[(id||'').split('').reduce((a,c)=>a+c.charCodeAt(0),0)%GRAD.length];}
function inits(n){return (n||'').split(' ').slice(0,2).map(w=>w[0]).join('').toUpperCase()||'?';}
function fmt(iso){if(!iso)return '';const d=new Date(iso),diff=Date.now()-d;if(diff<3600000)return Math.floor(diff/60000)+'min atr√°s';return d.toLocaleTimeString('pt-BR',{hour:'2-digit',minute:'2-digit'});}
function esc(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

async function init(){
  const{data:{session}}=await sb.auth.getSession();
  if(!session){location.href='index.html';return;}
  uid=session.user.id;
  buildColors();await loadStatuses();
}
async function loadStatuses(){
  const{data}=await sb.from('status_updates').select('*,profiles:user_id(id,full_name,avatar_url)').gt('expires_at',new Date().toISOString()).order('created_at',{ascending:false});
  const list=data||[];
  const mine=list.filter(s=>s.user_id===uid);
  document.getElementById('myStatusSub').textContent=mine.length?mine.length+' atualiza√ß√£o(√µes) ativas':'Toque para adicionar um status';
  const others=list.filter(s=>s.user_id!==uid);
  const el=document.getElementById('statusGrid');
  if(!others.length){el.innerHTML='';document.getElementById('emptyStatus').style.display='';return;}
  document.getElementById('emptyStatus').style.display='none';
  el.innerHTML=others.map(s=>{
    const name=(s.profiles&&s.profiles.full_name)||'Usu√°rio';
    const bg=s.bg_color||'#111927';
    const media=s.media_url?'<img src="'+s.media_url+'" style="width:100%;height:140px;object-fit:cover;display:block;">'
      :'<div class="status-card-placeholder" style="background:'+bg+';color:#fff;font-family:var(--font-d);font-size:.9rem;padding:12px;text-align:center;">'+esc(s.content||'üì∑')+'</div>';
    return '<div class="status-card" onclick="viewStatus(''+s.id+'',''+esc(name)+'',''+s.created_at+'',''+(s.media_url||'')+'',''+esc(s.content||'')+'',''+bg+'')">'+media+'<div style="padding:10px 12px;"><div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;"><div style="width:26px;height:26px;border-radius:50%;background:'+grad(s.user_id)+';display:flex;align-items:center;justify-content:center;font-family:var(--font-d);font-weight:700;font-size:.6rem;color:#000;">'+inits(name)+'</div><span style="font-size:.82rem;font-weight:600;">'+esc(name)+'</span></div><div style="font-size:.7rem;color:var(--t2);">'+fmt(s.created_at)+'</div></div></div>';
  }).join('');
}
function buildColors(){document.getElementById('colorDots').innerHTML=BG.map(c=>'<div style="width:26px;height:26px;border-radius:50%;background:'+c+';cursor:pointer;border:2px solid '+(c===selectedColor?'#fff':'transparent')+';transition:.2s;" onclick="selColor(''+c+'',this)"></div>').join('');}
function selColor(c,el){selectedColor=c;document.querySelectorAll('#colorDots div').forEach(d=>{d.style.borderColor='transparent';});el.style.borderColor='#fff';document.getElementById('composeBg').style.background=c;}
function openCompose(){document.getElementById('composeOverlay').classList.add('open');}
function closeCompose(){document.getElementById('composeOverlay').classList.remove('open');selectedMedia=null;document.getElementById('composeImgPrev').style.display='none';document.getElementById('composeTextPrev').style.display='none';document.getElementById('composeCaption').value='';}
function loadMedia(e){const f=e.target.files[0];if(!f)return;selectedMedia=f;const r=new FileReader();r.onload=ev=>{const img=document.getElementById('composeImgPrev');img.src=ev.target.result;img.style.display='block';document.getElementById('composeTextPrev').style.display='none';};r.readAsDataURL(f);openCompose();}
function updatePrev(){const txt=document.getElementById('composeCaption').value;const p=document.getElementById('composeTextPrev');if(txt&&!selectedMedia){p.textContent=txt;p.style.display='block';}else p.style.display='none';}
async function postStatus(){
  const caption=document.getElementById('composeCaption').value.trim();
  if(!caption&&!selectedMedia){showToast('Escreva algo ou escolha uma foto');return;}
  let mediaUrl=null,mediaType='text';
  if(selectedMedia){const ext=selectedMedia.name.split('.').pop();const path='status/'+uid+'_'+Date.now()+'.'+ext;await sb.storage.from('media').upload(path,selectedMedia,{upsert:true});const{data:{publicUrl}}=sb.storage.from('media').getPublicUrl(path);mediaUrl=publicUrl;mediaType=selectedMedia.type.startsWith('video')?'video':'image';}
  await sb.from('status_updates').insert({user_id:uid,content:caption,media_url:mediaUrl,media_type:mediaType,bg_color:selectedColor});
  closeCompose();await loadStatuses();showToast('Status publicado!');
}
function viewStatus(id,name,time,mediaUrl,content,bg){
  document.getElementById('viewAv').textContent=inits(name);document.getElementById('viewAv').style.background=grad(id);document.getElementById('viewName').textContent=name;document.getElementById('viewTime').textContent=fmt(time);
  document.getElementById('viewContent').innerHTML=mediaUrl?'<img src="'+mediaUrl+'" style="max-width:100%;max-height:calc(100vh - 140px);object-fit:contain;">'
    :'<div style="font-family:var(--font-d);font-size:1.4rem;font-weight:700;text-align:center;padding:32px;color:#fff;background:'+bg+';width:100%;min-height:300px;display:flex;align-items:center;justify-content:center;">'+esc(content)+'</div>';
  document.getElementById('viewBars').innerHTML='<div class="view-progress" style="flex:1;"><div class="view-progress-bar"></div></div>';
  document.getElementById('viewOverlay').classList.add('open');
  sb.from('status_views').upsert({status_id:id,viewer_id:uid},{onConflict:'status_id,viewer_id'});
  setTimeout(closeView,5500);
}
function closeView(){document.getElementById('viewOverlay').classList.remove('open');}
function showToast(m){const t=document.createElement('div');t.className='toast';t.textContent=m;document.getElementById('toaster').appendChild(t);setTimeout(()=>t.remove(),3000);}
init();
</script></body></html>